{"version":3,"sources":["progress-control.js"],"names":["define","langx","styler","noder","eventer","$","plugins","ranges","players","ProgressControl","Progress","inherit","klassName","pluginName","options","selectors","progressBar","seek","seekTooltip","_construct","elm","prototype","call","this","$media","_media","media","listenTo","updateProgress","updateDuration","duration","Math","round","$seek","attr","$progressBar","currentTime","floor","val","updateSeekTooltip","event","pos","pagePosition","$seekTooltip","css","pageX","left","skipAhead","register"],"mappings":";;;;;;;AAAAA,QACE,gBACA,sBACA,qBACA,uBACA,qBACA,4BACA,8BACA,aACA,SAASC,EAAMC,EAAOC,EAAOC,EAAQC,EAAIC,EAAQC,EAAOC,GACxD,aAEA,IAAIC,EAAkBF,EAAOG,SAASC,SACpCC,UAAY,kBAEZC,WAAa,gCAEbC,SACEC,WACEC,YAAc,gBACdC,KAAO,QACPC,YAAc,kBAKlBC,WAAY,SAASC,EAAKN,GACxBP,EAAOG,SAASW,UAAUF,WAAWG,KAAKC,KAAKH,EAAIN,GAEzCS,KAAKlB,IACCkB,KAAKT,QAAQC,UAD7B,IAEIS,EAASD,KAAKE,OAASF,KAAKT,QAAQY,MAGxCH,KAAKI,SAASH,EAAO,aAAaD,KAAKK,gBAEvCL,KAAKI,SAASH,EAAO,iBAAiBD,KAAKM,iBAM7CA,eAAiB,WAChB,IAAIH,EAAQH,KAAKE,OAChB,MAAMK,EAAWC,KAAKC,MAAMN,EAAMI,YAClCP,KAAKU,MAAMC,KAAK,MAAOJ,GACvBP,KAAKY,aAAaD,KAAK,MAAOJ,IAMhCF,eAAiB,WACjB,IAAIF,EAAQH,KAAKE,OAClBW,EAAcL,KAAKM,MAAMX,EAAMU,eAC3Bb,KAAKU,MAAMK,IAAIF,GACfb,KAAKY,aAAaG,IAAIF,IAMzBG,kBAAoB,SAAUC,GAC5BjC,EAAOG,SAASW,UAAUkB,kBAAkBjB,KAAKC,KAAKiB,GAGtD,MAAMC,EAAMlB,KAAKE,OAAOiB,eACxBnB,KAAKoB,aAAaC,IAAI,UAAWJ,EAAMK,MAAQJ,EAAIK,WAKrDC,UAAY,SAAUP,GACpBjC,EAAOG,SAASW,UAAU0B,UAAUzB,KAAKC,KAAKiB,GAElCjB,KAAKE,OACXW,YAAYb,KAAKU,MAAMK,UAQjC,OAFAhC,EAAQ0C,SAASvC,GAEVD,EAAQC,gBAAkBA","file":"../progress-control.js","sourcesContent":["define([\r\n  \"skylark-langx\",\r\n  \"skylark-domx-styler\",\r\n  \"skylark-domx-noder\",\r\n  \"skylark-domx-eventer\",\r\n  \"skylark-domx-query\",\r\n  \"skylark-domx-plugins-base\",\r\n  \"skylark-domx-plugins-ranges\",\r\n  \"./players\"\r\n],function(langx,styler,noder, eventer,$ , plugins,ranges,players) {\r\n  'use strict'\r\n\r\n  var ProgressControl = ranges.Progress.inherit({\r\n    klassName : \"ProgressControl\",\r\n\r\n    pluginName : \"domx.players.progress_control\",\r\n   \r\n    options : {\r\n      selectors : {\r\n        progressBar : '.progress-bar',\r\n        seek : '.seek',\r\n        seekTooltip : '.seek-tooltip'\r\n      }\r\n    },\r\n\r\n\r\n    _construct: function(elm, options) {\r\n      ranges.Progress.prototype._construct.call(this,elm,options);\r\n\r\n      let $el = this.$(),\r\n          selectors = this.options.selectors,\r\n          $media = this._media = this.options.media;\r\n\r\n      // Add eventlisteners here\r\n      this.listenTo($media,'timeupdate',this.updateProgress);\r\n\r\n      this.listenTo($media,'loadedmetadata',this.updateDuration);\r\n\r\n    },\r\n\r\n    // initializeVideo sets the video duration, and maximum value of the\r\n    // progressBar\r\n    updateDuration : function () {\r\n    \tvar media = this._media;\r\n     \tconst duration = Math.round(media.duration());    \t\t\r\n     \tthis.$seek.attr('max', duration);\r\n     \tthis.$progressBar.attr('max', duration);\r\n    },\r\n\r\n\r\n    // updateProgress indicates how far through the video\r\n    // the current playback is by updating the progress bar\r\n    updateProgress : function () {\r\n\t\t  var media = this._media,\r\n\t\t\tcurrentTime = Math.floor(media.currentTime());\r\n      \tthis.$seek.val(currentTime);\r\n      \tthis.$progressBar.val(currentTime);\r\n    },\r\n\r\n    // updateSeekTooltip uses the position of the mouse on the progress bar to\r\n    // roughly work out what point in the video the user will skip to if\r\n    // the progress bar is clicked at that point\r\n    updateSeekTooltip : function (event) {\r\n      ranges.Progress.prototype.updateSeekTooltip.call(this,event);\r\n\r\n      //const rect = this._media.getBoundingClientRect();\r\n      const pos = this._media.pagePosition();\r\n      this.$seekTooltip.css(\"left\", `${event.pageX - pos.left}px`);\r\n    },\r\n\r\n    // skipAhead jumps to a different point in the video when the progress bar\r\n    // is clicked\r\n    skipAhead : function (event) {\r\n      ranges.Progress.prototype.skipAhead.call(this,event);\r\n\r\n      let media = this._media;\r\n      media.currentTime(this.$seek.val());\r\n    },\r\n\r\n\r\n  });\r\n\r\n  plugins.register(ProgressControl);\r\n\r\n  return players.ProgressControl = ProgressControl;\r\n});"]}