/**
 * skylark-domx-plugins-players - A  ui library for rendering various media data specified by mime-type.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(t,s){var e=s.define,require=s.require,o="function"==typeof e&&e.amd,i=!o&&"undefined"!=typeof exports;if(!o&&!e){var l={};e=s.define=function(t,s,e){"function"==typeof e?(l[t]={factory:e,deps:s.map(function(s){return function(t,s){if("."!==t[0])return t;var e=s.split("/"),o=t.split("/");e.pop();for(var i=0;i<o.length;i++)"."!=o[i]&&(".."==o[i]?e.pop():e.push(o[i]));return e.join("/")}(s,t)}),resolved:!1,exports:null},require(t)):l[t]={factory:null,resolved:!0,exports:e}},require=s.require=function(t){if(!l.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=l[t];if(!module.resolved){var e=[];module.deps.forEach(function(t){e.push(require(t))}),module.exports=module.factory.apply(s,e)||null,module.resolved=!0}return module.exports}}if(!e)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-domx-plugins-players/players",["skylark-domx-plugins-base/plugins"],function(t){"use strict";return t.players={}}),t("skylark-domx-plugins-toggles/Pip",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-query","skylark-domx-plugins-base","./toggles"],function(t,s,e,o,i,l,a){"use strict";var n=l.Plugin.inherit({klassName:"Pip",pluginName:"domx.toggles.pip",options:{classes:{mini:"mini",unmini:"unmini"},selectors:{pipButton:null}},_construct:function(t,s){l.Plugin.prototype._construct.call(this,t,s);let e=this.$(),o=this.options.selectors;this.target=this.elmx(this.options.target);o.pipButton?this.$pipButton=e.find(o.pipButton):this.$pipButton=e,this.listenTo(this.$pipButton,"click",this.togglePip),"pictureInPictureEnabled"in document||this.$pipButton.hide()},togglePip:function(){try{let t=this.target.elm();t!==e.pictureInPicture()?(this.$pipButton.disabled(!0),e.pictureInPicture(t)):e.pictureInPicture(!1)}catch(t){console.error(t)}finally{this.$pipButton.disabled(!1)}}});return l.register(n),a.Pip=n}),t("skylark-domx-plugins-players/play-control",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-query","skylark-domx-plugins-base","./players"],function(t,s,e,o,i,l,a){"use strict";var n=l.Plugin.inherit({klassName:"PlayControl",pluginName:"domx.players.play_control",options:{titles:{play:"Play (k)",pause:"Pause (k)"},classes:{play:"play",pause:"pause"},selectors:{playButton:null}},_construct:function(t,s){l.Plugin.prototype._construct.call(this,t,s);let e=this.$(),o=this.options.selectors,i=this._media=this.options.media;o.playButton?this.$playButton=e.find(o.playButton):this.$playButton=e,this.listenTo(i,"click",this.togglePlay),this.listenTo(i,"play,pause",this.updatePlayButton),this.listenTo(this.$playButton,"click",this.togglePlay),this.updatePlayButton()},play:function(){this._media.play()},stop:function(){this._media.stop()},pause:function(){this._media.pause()},togglePlay:function(){this._media.paused()||this._media.ended()?this._media.play():this._media.pause()},updatePlayButton:function(){this._media.paused()?(this.$playButton.attr("data-title",this.options.titles.play),this.$playButton.removeClass(this.options.classes.pause).addClass(this.options.classes.play)):(this.$playButton.attr("data-title",this.options.titles.pause),this.$playButton.removeClass(this.options.classes.play).addClass(this.options.classes.pause))}});return l.register(n),a.PlayControl=n}),t("skylark-domx-plugins-players/progress-control",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-query","skylark-domx-plugins-base","skylark-domx-plugins-ranges","./players"],function(t,s,e,o,i,l,a,n){"use strict";var r=a.Progress.inherit({klassName:"ProgressControl",pluginName:"domx.players.progress_control",options:{selectors:{progressBar:".progress-bar",seek:".seek",seekTooltip:".seek-tooltip"}},_construct:function(t,s){a.Progress.prototype._construct.call(this,t,s);this.$(),this.options.selectors;let e=this._media=this.options.media;this.listenTo(e,"timeupdate",this.updateProgress),this.listenTo(e,"loadedmetadata",this.updateDuration)},updateDuration:function(){var t=this._media;const s=Math.round(t.duration());this.$seek.attr("max",s),this.$progressBar.attr("max",s)},updateProgress:function(){var t=this._media,s=Math.floor(t.currentTime());this.$seek.val(s),this.$progressBar.val(s)},updateSeekTooltip:function(t){a.Progress.prototype.updateSeekTooltip.call(this,t);const s=this._media.pagePosition();this.$seekTooltip.css("left",`${t.pageX-s.left}px`)},skipAhead:function(t){a.Progress.prototype.skipAhead.call(this,t);let s=this._media;s.currentTime(this.$seek.val())}});return l.register(r),n.ProgressControl=r}),t("skylark-domx-plugins-players/time-control",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-query","skylark-domx-plugins-base"],function(t,s,e,o,i,l){"use strict";var a=l.Plugin.inherit({klassName:"TimeControl",pluginName:"domx.players.time_control",options:{selectors:{timeElapsed:".time-elapsed",duration:".duration"}},_construct:function(t,s){l.Plugin.prototype._construct.call(this,t,s);let e=this.$(),o=this.options.selectors,i=this._media=this.options.media;this.$timeElapsed=e.find(o.timeElapsed),this.$duration=e.find(o.duration),this.listenTo(i,"timeupdate",this.updateTimeElapsed),this.listenTo(i,"loadedmetadata",this.updateDuration)},formatTime:function(t){const s=new Date(1e3*t).toISOString().substr(11,8);return{minutes:s.substr(3,2),seconds:s.substr(6,2)}},updateDuration:function(){var t=this._media;const s=Math.round(t.duration()),e=this.formatTime(s);this.$duration.text(`${e.minutes}:${e.seconds}`),this.$duration.attr("datetime",`${e.minutes}m ${e.seconds}s`)},updateTimeElapsed:function(){const t=this.formatTime(Math.round(this._media.currentTime()));this.$timeElapsed.text(`${t.minutes}:${t.seconds}`),this.$timeElapsed.attr("datetime",`${t.minutes}m ${t.seconds}s`)}});return l.register(a),a}),t("skylark-domx-plugins-players/volume-control",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-query","skylark-domx-plugins-base","./players"],function(t,s,e,o,i,l,a){"use strict";var n=l.Plugin.inherit({klassName:"VolumeControl",pluginName:"domx.players.volume_control",options:{selectors:{volumeButton:".volume-button",volumeIcons:".volume-button use",volumeMute:'use[href="#volume-mute"]',volumeLow:'use[href="#volume-low"]',volumeHigh:'use[href="#volume-high"]',volume:".volume"}},_construct:function(t,s){l.Plugin.prototype._construct.call(this,t,s),this._media=this.options.media;let e=this.$(),o=this.options.selectors,i=this._media=this.options.media;this.$volumeButton=e.find(o.volumeButton),this.$volumeIcons=e.find(o.volumeIcons),this.$volumeMute=e.find(o.volumeMute),this.$volumeLow=e.find(o.volumeLow),this.$volumeHigh=e.find(o.volumeHigh),this.$volume=e.find(o.volume),this.listenTo(i,"volumechange",this.updateVolumeIcon),this.listenTo(this.$volume,"input",this.updateVolume),this.listenTo(this.$volumeButton,"click",this.toggleMute),this.updateVolumeIcon()},updateVolume:function(){this._media.muted()&&this._media.muted(!1),this._media.volume(this.$volume.val())},updateVolumeIcon:function(){this.$volumeIcons.forEach(t=>{i(t).hide()}),this.$volumeButton.data("title","Mute (m)"),this._media.muted()||0===this._media.volume()?(this.$volumeMute.show(),this.$volumeButton.data("title","Unmute (m)")):this._media.volume()>0&&this._media.volume()<=.5?this.$volumeLow.show():this.$volumeHigh.show()},toggleMute:function(){this._media.muted(!this._media.muted()),this._media.muted()?(this.$volume.data("volume",this.$volume.val()),this.$volume.val(0)):this.$volume.val(this.$volume.data("volume"))}});return l.register(n),a.VolumeControl=n}),t("skylark-domx-plugins-players/controls-bar",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-medias","skylark-domx-query","skylark-domx-plugins-base","skylark-domx-plugins-toggles/fullscreen","skylark-domx-plugins-toggles/Pip","./players","./play-control","./progress-control","./time-control","./volume-control"],function(t,s,e,o,i,l,a,n,r,u,p,m,d,h){"use strict";var c=a.Plugin.inherit({klassName:"ControlsBar",pluginName:"domx.players.controls_bar",options:{selectors:{playButton:".play-button",playbackIcons:".playback-icons use",timeControl:".time",timeElapsed:".time-elapsed",duration:".duration",progressControl:".video-progress",progressBar:".progress-bar",seek:".seek",seekTooltip:".seek-tooltip",volumeControl:".volume-control",volumeButton:".volume-button",volumeIcons:".volume-button use",volumeMute:'use[href="#volume-mute"]',volumeLow:'use[href="#volume-low"]',volumeHigh:'use[href="#volume-high"]',volume:".volume",fullscreenButton:".fullscreen-button",fullscreenIcons:".fullscreen-button use",pipButton:".pip-button"}},_construct:function(t,s){a.Plugin.prototype._construct.call(this,t,s);let e=this.$(),o=this.options.selectors,i=this.options.media,l=this.options.container;this._playControl=p.instantiate(e.find(o.playButton)[0],{media:i}),this._timeControl=d.instantiate(e.find(o.timeControl)[0],{media:i}),this._progressControl=m.instantiate(e.find(o.progressControl)[0],{media:i}),this._volumeControl=h.instantiate(e.find(o.volumeControl)[0],{media:i}),this._fullscreen=n.instantiate(e.find(o.fullscreenButton)[0],{target:l}),this._pip=r.instantiate(e.find(o.pipButton)[0],{target:i})}});return a.register(c),u.ControlsBar=c}),t("skylark-domx-plugins-players/playback-animation",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-animates","skylark-domx-query","skylark-domx-plugins-base"],function(t,s,e,o,i,l,a){"use strict";var n=a.Plugin.inherit({klassName:"PlaybackAnimation",pluginName:"domx.players.playback_animation",options:{classes:{play:"play",pause:"pause"},selectors:{playbackAnimation:null}},_construct:function(t,s){a.Plugin.prototype._construct.call(this,t,s);let e=this.$(),o=this.options.selectors,i=this._media=this.options.media;o.playbackAnimation?this.$playbackAnimation=e.find(o.playbackAnimation):this.$playbackAnimation=e,this.listenTo(i,"click",this.animatePlayback)},animatePlayback:function(){this._media.paused()?this.$playbackAnimation.removeClass(this.options.classes.play).addClass(this.options.classes.pause):this.$playbackAnimation.removeClass(this.options.classes.pause).addClass(this.options.classes.play),this.$playbackAnimation.animate([{opacity:1,transform:"scale(1)"},{opacity:0,transform:"scale(1.3)"}],{duration:500})}});return a.register(n),n}),t("skylark-domx-plugins-players/video-player",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-medias","skylark-domx-query","skylark-domx-plugins-base","./players","./controls-bar","./playback-animation"],function(t,s,e,o,i,l,a,n,r,u){"use strict";var p=a.Plugin.inherit({klassName:"VideoPlayer",pluginName:"domx.players.video",options:{selectors:{video:"video",videoControls:".video-controls",playbackAnimation:".playback-animation"}},_construct:function(t,s){a.Plugin.prototype._construct.call(this,t,s);let e=this.$(),o=this.options.selectors;this.$video=this.elmx().find(o.video),this.$videoControls=e.find(o.videoControls),this._controlsBar=r.instantiate(this.$videoControls[0],{media:this.$video,container:this.elmx()}),this._playbackAnimation=u.instantiate(e.find(o.playbackAnimation)[0],{media:this.$video}),this.listenTo(e,"mouseenter",this.showControls),this.listenTo(e,"mouseleave",this.hideControls),this.listenTo(l(document),"keyup",this.keyboardShortcuts);const i=!!document.createElement("video").canPlayType;i&&(this.$video.controls(!1),this.$videoControls.show()),this.load()},source:function(t){this._media=t;let s=t.title||"",e=t.href,o=t.type,i=t.poster||"",l=t.altText||"",a=this.$(),n=this._video,r=this._$play,u=this._$poster;a.prop("title",s),n.canPlayType&&e&&o&&n.canPlayType(o)&&(n.src=e),n.poster=i,u.prop({src:i,alt:l}),r.prop({download:s,href:e})},load:function(){this.$video.load()},play:function(){this.$video.play()},stop:function(){this.$video.stop()},pause:function(){this.$video.pause()},togglePlay:function(){this.$video.paused()||this.$video.ended()?this.$video.play():this.$video.pause()},hideControls:function(){this.$video.paused()||this.$videoControls.hide()},showControls:function(){this.$videoControls.show()},keyboardShortcuts:function(t){const{key:s}=t;switch(s){case"k":this.togglePlay(),this._playbackAnimation.animatePlayback(),this.$video.paused()?this.showControls():setTimeout(()=>{this.hideControls()},2e3);break;case"m":this._volumeControl.toggleMute();break;case"f":this._fullscreen.toggleFullScreen();break;case"p":this._pip.togglePip()}}});return a.register(p),n.VideoPlayer=p}),t("skylark-domx-plugins-players/main",["./players","./video-player"],function(t){return t}),t("skylark-domx-plugins-players",["skylark-domx-plugins-players/main"],function(t){return t})}(e),!o){var a=require("skylark-langx-ns");i?module.exports=a:s.skylarkjs=a}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-domx-plugins-players.js.map
