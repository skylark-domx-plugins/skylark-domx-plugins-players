/**
 * skylark-domx-plugins-players - A  ui library for rendering various media data specified by mime-type.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(t,e){var s=e.define,require=e.require,i="function"==typeof s&&s.amd,o=!i&&"undefined"!=typeof exports;if(!i&&!s){var a={};s=e.define=function(t,e,s){"function"==typeof s?(a[t]={factory:s,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var s=e.split("/"),i=t.split("/");s.pop();for(var o=0;o<i.length;o++)"."!=i[o]&&(".."==i[o]?s.pop():s.push(i[o]));return s.join("/")}(e,t)}),resolved:!1,exports:null},require(t)):a[t]={factory:null,resolved:!0,exports:s}},require=e.require=function(t){if(!a.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=a[t];if(!module.resolved){var s=[];module.deps.forEach(function(t){s.push(require(t))}),module.exports=module.factory.apply(e,s)||null,module.resolved=!0}return module.exports}}if(!s)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-domx-plugins-players/players",["skylark-domx-plugins-base/plugins"],function(t){"use strict";return t.players={}}),t("skylark-domx-plugins-toggles/Pip",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-query","skylark-domx-plugins-base","./toggles"],function(t,e,s,i,o,a,l){"use strict";var n=a.Plugin.inherit({klassName:"Pip",pluginName:"domx.toggles.pip",options:{classes:{mini:"mini",unmini:"unmini"},selectors:{pipButton:null}},_construct:function(t,e){a.Plugin.prototype._construct.call(this,t,e);let s=this.$(),i=this.options.selectors;this.target=this.elmx(this.options.target);i.pipButton?this.$pipButton=s.find(i.pipButton):this.$pipButton=s,this.listenTo(this.$pipButton,"click",this.togglePip),"pictureInPictureEnabled"in document||this.$pipButton.hide()},togglePip:function(){try{let t=this.target.elm();t!==s.pictureInPicture()?(this.$pipButton.disabled(!0),s.pictureInPicture(t)):s.pictureInPicture(!1)}catch(t){console.error(t)}finally{this.$pipButton.disabled(!1)}}});return a.register(n),l.Pip=n}),t("skylark-domx-plugins-players/play-control",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-query","skylark-domx-plugins-base","./players"],function(t,e,s,i,o,a,l){"use strict";var n=a.Plugin.inherit({klassName:"PlayControl",pluginName:"domx.players.play_control",options:{titles:{play:"Play (k)",pause:"Pause (k)"},classes:{play:"play",pause:"pause"},selectors:{playButton:null}},_construct:function(t,e){a.Plugin.prototype._construct.call(this,t,e);let s=this.$(),i=this.options.selectors,o=this._media=this.options.media;i.playButton?this.$playButton=s.find(i.playButton):this.$playButton=s,this.listenTo(o,"click",this.togglePlay),this.listenTo(o,"play,pause",this.updatePlayButton),this.listenTo(this.$playButton,"click",this.togglePlay),this.updatePlayButton()},play:function(){this._media.play()},stop:function(){this._media.stop()},pause:function(){this._media.pause()},togglePlay:function(){this._media.paused()||this._media.ended()?this._media.play():this._media.pause()},updatePlayButton:function(){this._media.paused()?(this.$playButton.attr("data-title",this.options.titles.play),this.$playButton.removeClass(this.options.classes.pause).addClass(this.options.classes.play)):(this.$playButton.attr("data-title",this.options.titles.pause),this.$playButton.removeClass(this.options.classes.play).addClass(this.options.classes.pause))}});return a.register(n),l.PlayControl=n}),t("skylark-domx-plugins-players/playback-animation",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-animates","skylark-domx-query","skylark-domx-plugins-base"],function(t,e,s,i,o,a,l){"use strict";var n=l.Plugin.inherit({klassName:"PlaybackAnimation",pluginName:"domx.players.playback_animation",options:{classes:{play:"play",pause:"pause"},selectors:{playbackAnimation:null}},_construct:function(t,e){l.Plugin.prototype._construct.call(this,t,e);let s=this.$(),i=this.options.selectors,o=this._media=this.options.media;i.playbackAnimation?this.$playbackAnimation=s.find(i.playbackAnimation):this.$playbackAnimation=s,this.listenTo(o,"click",this.animatePlayback)},animatePlayback:function(){this._media.paused()?this.$playbackAnimation.removeClass(this.options.classes.play).addClass(this.options.classes.pause):this.$playbackAnimation.removeClass(this.options.classes.pause).addClass(this.options.classes.play),this.$playbackAnimation.animate([{opacity:1,transform:"scale(1)"},{opacity:0,transform:"scale(1.3)"}],{duration:500})}});return l.register(n),n}),t("skylark-domx-plugins-players/progress-control",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-query","skylark-domx-plugins-base","./players"],function(t,e,s,i,o,a,l){"use strict";var n=a.Plugin.inherit({klassName:"ProgressControl",pluginName:"domx.players.progress_control",options:{selectors:{progressBar:".progress-bar",seek:".seek",seekTooltip:".seek-tooltip"}},_construct:function(t,e){a.Plugin.prototype._construct.call(this,t,e);let s=this.$(),i=this.options.selectors,o=this._media=this.options.media;this.$progressBar=s.find(i.progressBar),this.$seek=s.find(i.seek),this.$seekTooltip=s.find(i.seekTooltip),this.listenTo(o,"timeupdate",this.updateProgress),this.listenTo(this.$seek,"mousemove",this.updateSeekTooltip),this.listenTo(this.$seek,"input",this.skipAhead),this.listenTo(o,"loadedmetadata",this.updateDuration)},formatTime:function(t){const e=new Date(1e3*t).toISOString().substr(11,8);return{minutes:e.substr(3,2),seconds:e.substr(6,2)}},updateDuration:function(){var t=this._media;const e=Math.round(t.duration());this.$seek.attr("max",e),this.$progressBar.attr("max",e)},updateProgress:function(){var t=this._media,e=Math.floor(t.currentTime());this.$seek.val(e),this.$progressBar.val(e)},updateSeekTooltip:function(t){const e=Math.round(t.offsetX/t.target.clientWidth*parseInt(t.target.getAttribute("max"),10));this.$seek.attr("seek",e);const s=this.formatTime(e);this.$seekTooltip.text(`${s.minutes}:${s.seconds}`);const i=this._media.pagePosition();this.$seekTooltip.css("left",`${t.pageX-i.left}px`)},skipAhead:function(t){const e=t.target.dataset.seek?t.target.dataset.seek:t.target.value;let s=this._media;s.currentTime(e),this.$progressBar.val(e),this.$seek.val(e)}});return a.register(n),l.ProgressControl=n}),t("skylark-domx-plugins-players/time-control",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-query","skylark-domx-plugins-base"],function(t,e,s,i,o,a){"use strict";var l=a.Plugin.inherit({klassName:"TimeControl",pluginName:"domx.players.time_control",options:{selectors:{timeElapsed:".time-elapsed",duration:".duration"}},_construct:function(t,e){a.Plugin.prototype._construct.call(this,t,e);let s=this.$(),i=this.options.selectors,o=this._media=this.options.media;this.$timeElapsed=s.find(i.timeElapsed),this.$duration=s.find(i.duration),this.listenTo(o,"timeupdate",this.updateTimeElapsed),this.listenTo(o,"loadedmetadata",this.updateDuration)},formatTime:function(t){const e=new Date(1e3*t).toISOString().substr(11,8);return{minutes:e.substr(3,2),seconds:e.substr(6,2)}},updateDuration:function(){var t=this._media;const e=Math.round(t.duration()),s=this.formatTime(e);this.$duration.text(`${s.minutes}:${s.seconds}`),this.$duration.attr("datetime",`${s.minutes}m ${s.seconds}s`)},updateTimeElapsed:function(){const t=this.formatTime(Math.round(this._media.currentTime()));this.$timeElapsed.text(`${t.minutes}:${t.seconds}`),this.$timeElapsed.attr("datetime",`${t.minutes}m ${t.seconds}s`)}});return a.register(l),l}),t("skylark-domx-plugins-players/volume-control",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-query","skylark-domx-plugins-base","./players"],function(t,e,s,i,o,a,l){"use strict";var n=a.Plugin.inherit({klassName:"VolumeControl",pluginName:"domx.players.volume_control",options:{selectors:{volumeButton:".volume-button",volumeIcons:".volume-button use",volumeMute:'use[href="#volume-mute"]',volumeLow:'use[href="#volume-low"]',volumeHigh:'use[href="#volume-high"]',volume:".volume"}},_construct:function(t,e){a.Plugin.prototype._construct.call(this,t,e),this._media=this.options.media;let s=this.$(),i=this.options.selectors,o=this._media=this.options.media;this.$volumeButton=s.find(i.volumeButton),this.$volumeIcons=s.find(i.volumeIcons),this.$volumeMute=s.find(i.volumeMute),this.$volumeLow=s.find(i.volumeLow),this.$volumeHigh=s.find(i.volumeHigh),this.$volume=s.find(i.volume),this.listenTo(o,"volumechange",this.updateVolumeIcon),this.listenTo(this.$volume,"input",this.updateVolume),this.listenTo(this.$volumeButton,"click",this.toggleMute),this.updateVolumeIcon()},updateVolume:function(){this._media.muted()&&this._media.muted(!1),this._media.volume(this.$volume.val())},updateVolumeIcon:function(){this.$volumeIcons.forEach(t=>{o(t).hide()}),this.$volumeButton.data("title","Mute (m)"),this._media.muted()||0===this._media.volume()?(this.$volumeMute.show(),this.$volumeButton.data("title","Unmute (m)")):this._media.volume()>0&&this._media.volume()<=.5?this.$volumeLow.show():this.$volumeHigh.show()},toggleMute:function(){this._media.muted(!this._media.muted()),this._media.muted()?(this.$volume.data("volume",this.$volume.val()),this.$volume.val(0)):this.$volume.val(this.$volume.data("volume"))}});return a.register(n),l.VolumeControl=n}),t("skylark-domx-plugins-players/video-player",["skylark-langx","skylark-domx-styler","skylark-domx-noder","skylark-domx-eventer","skylark-domx-medias","skylark-domx-query","skylark-domx-plugins-base","skylark-domx-plugins-toggles/fullscreen","skylark-domx-plugins-toggles/Pip","./players","./play-control","./playback-animation","./progress-control","./time-control","./volume-control"],function(t,e,s,i,o,a,l,n,r,u,p,d,m,h,c){"use strict";var y=l.Plugin.inherit({klassName:"VideoPlayer",pluginName:"domx.players.video",options:{selectors:{video:"video",videoControls:".video-controls",playButton:".play-button",playbackIcons:".playback-icons use",timeControl:".time",timeElapsed:".time-elapsed",duration:".duration",progressControl:".video-progress",progressBar:".progress-bar",seek:".seek",seekTooltip:".seek-tooltip",volumeControl:".volume-control",volumeButton:".volume-button",volumeIcons:".volume-button use",volumeMute:'use[href="#volume-mute"]',volumeLow:'use[href="#volume-low"]',volumeHigh:'use[href="#volume-high"]',volume:".volume",playbackAnimation:".playback-animation",fullscreenButton:".fullscreen-button",fullscreenIcons:".fullscreen-button use",pipButton:".pip-button"}},_construct:function(t,e){l.Plugin.prototype._construct.call(this,t,e);let s=this.$(),i=this.options.selectors;this.$video=this.elmx().find(i.video),this.$videoControls=s.find(i.videoControls),this._playControl=p.instantiate(s.find(i.playButton)[0],{media:this.$video}),this._timeControl=h.instantiate(s.find(i.timeControl)[0],{media:this.$video}),this._progressControl=m.instantiate(s.find(i.progressControl)[0],{media:this.$video}),this._volumeControl=c.instantiate(s.find(i.volumeControl)[0],{media:this.$video}),this._playbackAnimation=d.instantiate(s.find(i.playbackAnimation)[0],{media:this.$video}),this._fullscreen=n.instantiate(s.find(i.fullscreenButton)[0],{target:this.elmx()}),this._pip=r.instantiate(s.find(i.pipButton)[0],{target:this.$video}),this.listenTo(a(this._videoControls),"mouseenter",this.showControls),this.listenTo(a(this._videoControls),"mouseleave",this.hideControls),this.listenTo(a(document),"keyup",this.keyboardShortcuts);const o=!!document.createElement("video").canPlayType;o&&(this.$video.controls(!1),this.$videoControls.show()),this.load()},source:function(t){this._media=t;let e=t.title||"",s=t.href,i=t.type,o=t.poster||"",a=t.altText||"",l=this.$(),n=this._video,r=this._$play,u=this._$poster;l.prop("title",e),n.canPlayType&&s&&i&&n.canPlayType(i)&&(n.src=s),n.poster=o,u.prop({src:o,alt:a}),r.prop({download:e,href:s})},load:function(){this.$video.load()},play:function(){this.$video.play()},stop:function(){this.$video.stop()},pause:function(){this.$video.pause()},togglePlay:function(){this.$video.paused()||this.$video.ended()?this.$video.play():this.$video.pause()},hideControls:function(){this.$video.paused()||e.addClass(this._videoControls,"hide")},showControls:function(){e.removeClass(this._videoControls,"hide")},keyboardShortcuts:function(t){const{key:e}=t;switch(e){case"k":this.togglePlay(),this._playbackAnimation.animatePlayback(),this.$video.paused()?this.showControls():setTimeout(()=>{this.hideControls()},2e3);break;case"m":this._volumeControl.toggleMute();break;case"f":this._fullscreen.toggleFullScreen();break;case"p":this._pip.togglePip()}}});return l.register(y),u.VideoPlayer=y}),t("skylark-domx-plugins-players/main",["./players","./video-player"],function(t){return t}),t("skylark-domx-plugins-players",["skylark-domx-plugins-players/main"],function(t){return t})}(s),!i){var l=require("skylark-langx-ns");o?module.exports=l:e.skylarkjs=l}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-domx-plugins-players.js.map
